version: '2'
services:
  mysql:
    image: mysql:5.7.12
    environment:
      - MYSQL_ROOT_PASSWORD=password
    volumes:
      - ./data/dump:/docker-entrypoint-initdb.d
  parsoid:
    build:
      context: .
      dockerfile: docker/parsoid/Dockerfile
    image: cllu/mediawiki-parsoid:1.26.2-1
  mediawiki:
    build:
      context: .
      dockerfile: docker/mediawiki/Dockerfile
    image: cllu/mediawiki:1.26.2-1
    ports:
      - 80:80
    links:
      - mysql
      - parsoid
    environment:
      WG_SECRET_KEY: ee0efe6c8b4bc1ee5ccd906ad783aeb20115f061a3f9d85e6850612104920701
      WG_UPGRADE_KEY: 08882e35d74f30cf
    volumes:
      - ./data/images:/var/www/html/w/images
